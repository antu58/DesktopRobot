services:
  cosyvoice-tts:
    build:
      context: ..
      dockerfile: cosyvoice-tts-playground/Dockerfile
      args:
        HTTP_PROXY: ${BUILD_HTTP_PROXY:-}
        HTTPS_PROXY: ${BUILD_HTTPS_PROXY:-}
        ALL_PROXY: ${BUILD_ALL_PROXY:-}
    restart: unless-stopped
    environment:
      COSY_MODEL_DIR: ${COSY_MODEL_DIR:-iic/CosyVoice-300M-SFT}
      HTTP_PROXY: ${RUNTIME_HTTP_PROXY:-}
      HTTPS_PROXY: ${RUNTIME_HTTPS_PROXY:-}
      ALL_PROXY: ${RUNTIME_ALL_PROXY:-}
      NO_PROXY: ${RUNTIME_NO_PROXY:-127.0.0.1,localhost}
      MODELSCOPE_CACHE: /models/modelscope
      HF_HOME: /models/huggingface
    ports:
      - "127.0.0.1:${COSY_WEB_PORT:-18388}:18388"
    volumes:
      - ./models:/models
